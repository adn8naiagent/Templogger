# Database Safety Rules

## Purpose

Prevent accidental data loss in production by enforcing safe schema changes.

## Rules

1. **No Destructive Operations**
   - Never DROP tables or columns
   - Never TRUNCATE tables
   - Never DELETE without WHERE clause
   - Never ALTER COLUMN types directly

2. **Additive Changes Only**
   - New tables: OK
   - New columns: OK
   - New indexes: OK
   - New constraints: Test carefully

3. **Safe Modification Patterns**

   ```sql
   -- Instead of: ALTER TABLE users DROP COLUMN old_field;
   -- Do: ALTER TABLE users ADD COLUMN archived_old_field;

   -- Instead of: ALTER TABLE products ALTER COLUMN price TYPE DECIMAL;
   -- Do:
   ALTER TABLE products ADD COLUMN price_decimal DECIMAL;
   UPDATE products SET price_decimal = price::DECIMAL;
   ```

## Migration Requirements

- All changes through migration files
- Test migrations locally first
- Include rollback strategy in comments
- Document why change is needed

## Enforcement

- Git hooks check for forbidden operations
- AI assistants refuse unsafe commands
- Code review requires safety check
